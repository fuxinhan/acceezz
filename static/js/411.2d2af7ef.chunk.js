"use strict";(self.webpackChunkwebapp=self.webpackChunkwebapp||[]).push([[411],{9411:(e,s,a)=>{a.r(s),a.d(s,{default:()=>ce});var n=a(9379),r=a(5043);const l="UserInfo_UserInfoPage__e810E",c="UserInfo_layout__zZ4UQ",i="UserInfo_sideMenu__a3RFU",t="UserInfo_menuItem__OYe7J",o="UserInfo_active__VyX9j",d="UserInfo_arrow__y3enO",h="UserInfo_content__rGOx-",m="UserInfo_section__4H76F",x="UserInfo_headerBar__femp9",u="UserInfo_title__iQeDo",_="UserInfo_sub__AnKl3",j="UserInfo_link__ga2a4",f="UserInfo_profileTop__48vwc",p="UserInfo_leftIntro__iCeAX",v="UserInfo_nameBlock__7EIAT",N="UserInfo_name__f0+if",y="UserInfo_location__wQ8XV",I="UserInfo_fieldList__EjPt4",g="UserInfo_fieldRow__KGF-3",A="UserInfo_fieldLabel__6Dvvb",U="UserInfo_fieldValue__EvUrJ",w="UserInfo_primaryBtn__lyv1k",b="UserInfo_card__aT8Tp",M="UserInfo_metaGrid__Fdt8f",C="UserInfo_metaLabel__RoiiM",k="UserInfo_metaValue__kFyBp",S="UserInfo_blockTitle__ToraI",P="UserInfo_inlineForm__XlPlI",X="UserInfo_modalActions__y9IEl",Y="UserInfo_avatarClickable__6v477",E="UserInfo_avatarModal__ZVD2q",D="UserInfo_cropperBody__vSO+J",R="UserInfo_emptyUploader__IKNl4",T="UserInfo_cropBox__vJJzx",q="UserInfo_cropImage__8Z677",F="UserInfo_cropMask__vEYyq",O="UserInfo_controls__Me8N2",B="UserInfo_scaleRow__CqsM6",W="UserInfo_scaleLabel__U5cu9",L="UserInfo_scaleSlider__UjZ3b",J="UserInfo_actionRow__1yNl1";var H=a(4400),V=a(5964),Z=a(5e3),z=a(2703),G=a(4209),K=a(5367),Q=a(9372),$=a(5558),ee=a(579);const se="profile",ae="password",ne="preferences",re="membership";function le(){const e=function(){try{const e=localStorage.getItem("userInfo");return e?JSON.parse(e):null}catch(e){return null}}(),s=(null===e||void 0===e?void 0:e.user_info)||{};return{username:s.username||"Member",email:s.email||"member@example.com",avatar:s.cover||null,location:s.location||"\u2014",dateOfBirth:s.dateOfBirth||null,address:s.address||"",phone:s.phone||""}}const ce=()=>{var e;const[s,a]=(0,r.useState)(se),[ce,ie]=(0,r.useState)(le()),[te,oe]=(0,r.useState)(!1),[de,he]=(0,r.useState)(!1),[me,xe]=(0,r.useState)(!1),[ue,_e]=(0,r.useState)(null),[je,fe]=(0,r.useState)(1),[pe,ve]=(0,r.useState)({x:0,y:0}),Ne=(0,r.useRef)({dragging:!1,startX:0,startY:0,originX:0,originY:0}),ye=(0,r.useRef)({startDistance:0,startScale:1}),Ie=(0,r.useRef)(null),ge=(0,r.useRef)(null),Ae=(0,r.useRef)(null);(0,r.useEffect)(()=>{ie(le())},[]);const Ue=()=>{localStorage.clear(),window.location.reload(!0)},we=()=>{var e;null===(e=ge.current)||void 0===e||e.click()},be=(e,s)=>{Ne.current={dragging:!0,startX:e,startY:s,originX:pe.x,originY:pe.y}},Me=(e,s)=>{const a=Ne.current;if(!a.dragging)return;const n=e-a.startX,r=s-a.startY;ve({x:a.originX+n,y:a.originY+r})},Ce=()=>{Ne.current.dragging=!1},ke=(e,s,a)=>Math.max(s,Math.min(a,e)),Se=(0,r.useMemo)(()=>(0,ee.jsxs)("aside",{className:i,children:[(0,ee.jsxs)("div",{className:s===se?"".concat(t," ").concat(o):t,onClick:()=>a(se),children:[(0,ee.jsx)("span",{children:"Profile"}),(0,ee.jsx)("span",{className:d,children:"\u203a"})]}),(0,ee.jsxs)("div",{className:s===ae?"".concat(t," ").concat(o):t,onClick:()=>a(ae),children:[(0,ee.jsx)("span",{children:"Change password"}),(0,ee.jsx)("span",{className:d,children:"\u203a"})]}),(0,ee.jsxs)("div",{className:s===ne?"".concat(t," ").concat(o):t,onClick:()=>a(ne),children:[(0,ee.jsx)("span",{children:"Preferences"}),(0,ee.jsx)("span",{className:d,children:"\u203a"})]}),(0,ee.jsxs)("div",{className:s===re?"".concat(t," ").concat(o):t,onClick:()=>a(re),children:[(0,ee.jsx)("span",{children:"Membership application"}),(0,ee.jsx)("span",{className:d,children:"\u203a"})]}),(0,ee.jsxs)("div",{className:t,onClick:Ue,children:[(0,ee.jsx)("span",{children:"Sign out"}),(0,ee.jsx)("span",{className:d,children:"\u203a"})]})]}),[s]);return(0,ee.jsx)("div",{className:l,children:(0,ee.jsxs)("div",{className:c,children:[Se,(0,ee.jsxs)("main",{className:h,children:[s===se&&(0,ee.jsxs)("section",{className:m,children:[(0,ee.jsxs)("header",{className:x,children:[(0,ee.jsx)("h2",{className:u,children:"Profile"}),(0,ee.jsxs)("p",{className:_,children:["Here you can edit your phone number and email address. This information is not visible to others. If you need to amend your personal details please get in touch. ",(0,ee.jsx)("a",{className:j,href:"#",children:"Contact us"})]})]}),(0,ee.jsx)("div",{className:f,children:(0,ee.jsxs)("div",{className:p,children:[(0,ee.jsx)("div",{className:Y,onClick:()=>{xe(!0)},title:"\u70b9\u51fb\u66f4\u6362\u5934\u50cf",children:(0,ee.jsx)(V.A,{size:80,src:ce.avatar,children:null===(e=ce.username)||void 0===e?void 0:e[0]})}),(0,ee.jsxs)("div",{className:v,children:[(0,ee.jsx)("div",{className:N,children:ce.username}),(0,ee.jsxs)("div",{className:y,children:["Location: ",ce.location||"\u2014"]})]})]})}),(0,ee.jsxs)("div",{className:I,children:[(0,ee.jsxs)("div",{className:g,children:[(0,ee.jsx)("div",{className:A,children:"Email"}),(0,ee.jsx)("div",{className:U,children:ce.email})]}),(0,ee.jsxs)("div",{className:g,children:[(0,ee.jsx)("div",{className:A,children:"Date of birth"}),(0,ee.jsx)("div",{className:U,children:ce.dateOfBirth||"\u2014"})]}),(0,ee.jsxs)("div",{className:g,children:[(0,ee.jsx)("div",{className:A,children:"Address"}),(0,ee.jsx)("div",{className:U,children:ce.address||"\u2014"})]}),(0,ee.jsxs)("div",{className:g,children:[(0,ee.jsx)("div",{className:A,children:"Phone"}),(0,ee.jsx)("div",{className:U,children:ce.phone||"\u2014"})]})]}),(0,ee.jsx)(Z.Ay,{className:w,onClick:()=>oe(!0),children:"Edit information"}),(0,ee.jsx)(z.A,{title:"Edit profile",open:te,onCancel:()=>oe(!1),footer:null,destroyOnClose:!0,children:(0,ee.jsxs)(G.A,{layout:"vertical",initialValues:ce,onFinish:e=>{const s=(0,n.A)((0,n.A)({},ce),e);console.log("profile_update",s),H.Ay.success("\u5df2\u6253\u5370\u5230\u63a7\u5236\u53f0"),oe(!1),ie(s=>(0,n.A)((0,n.A)({},s),e))},children:[(0,ee.jsx)(G.A.Item,{label:"Email",name:"email",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u90ae\u7bb1"}],children:(0,ee.jsx)(K.A,{placeholder:"your@email.com"})}),(0,ee.jsx)(G.A.Item,{label:"Date of birth",name:"dateOfBirth",children:(0,ee.jsx)(Q.A,{style:{width:"100%"}})}),(0,ee.jsx)(G.A.Item,{label:"Address",name:"address",children:(0,ee.jsx)(K.A,{placeholder:"Address"})}),(0,ee.jsx)(G.A.Item,{label:"Phone",name:"phone",children:(0,ee.jsx)(K.A,{placeholder:"Phone"})}),(0,ee.jsxs)("div",{className:X,children:[(0,ee.jsx)(Z.Ay,{onClick:()=>oe(!1),children:"Cancel"}),(0,ee.jsx)(Z.Ay,{type:"primary",htmlType:"submit",children:"Save"})]})]})}),(0,ee.jsxs)(z.A,{title:"Change avatar",open:me,onCancel:()=>xe(!1),footer:null,destroyOnClose:!0,className:E,children:[(0,ee.jsx)("input",{ref:ge,type:"file",accept:"image/*",style:{display:"none"},onChange:e=>{var s;const a=null===(s=e.target.files)||void 0===s?void 0:s[0];if(!a)return;const n=new FileReader;n.onload=()=>{_e(n.result),fe(1),ve({x:0,y:0})},n.readAsDataURL(a),e.target.value=""}}),(0,ee.jsx)("div",{className:D,children:ue?(0,ee.jsxs)(ee.Fragment,{children:[(0,ee.jsxs)("div",{className:T,ref:Ae,onMouseDown:e=>{e.preventDefault(),be(e.clientX,e.clientY)},onMouseMove:e=>{Me(e.clientX,e.clientY)},onMouseUp:Ce,onMouseLeave:Ce,onTouchStart:e=>{const s=e.touches;if(1===s.length){const e=s[0];be(e.clientX,e.clientY)}else if(2===s.length){const e=s[0],a=s[1],n=Math.sqrt(Math.pow(a.clientX-e.clientX,2)+Math.pow(a.clientY-e.clientY,2));ye.current={startDistance:n,startScale:je}}},onTouchMove:e=>{const s=e.touches;if(1===s.length){const e=s[0];Me(e.clientX,e.clientY)}else if(2===s.length){const e=s[0],a=s[1],n=Math.sqrt(Math.pow(a.clientX-e.clientX,2)+Math.pow(a.clientY-e.clientY,2)),{startDistance:r,startScale:l}=ye.current;if(r>0){const e=ke(l*(n/r),.5,4);if(fe(e),Ie.current&&Ae.current){const s=Ae.current.clientWidth,a=Ie.current,n=a.naturalWidth,r=a.naturalHeight,l=Math.max(s/n,s/r)*e,c=n*l,i=r*l,t=Math.max(0,(c-s)/2),o=Math.max(0,(i-s)/2);ve(e=>({x:ke(e.x,-t,t),y:ke(e.y,-o,o)}))}}}},onTouchEnd:Ce,onWheel:e=>{e.preventDefault();const s=e.deltaY>0?-.1:.1,a=ke(je+s,.5,4);if(fe(a),Ie.current&&Ae.current){const e=Ae.current.clientWidth,s=Ie.current,n=s.naturalWidth,r=s.naturalHeight,l=Math.max(e/n,e/r)*a,c=n*l,i=r*l,t=Math.max(0,(c-e)/2),o=Math.max(0,(i-e)/2);ve(e=>({x:ke(e.x,-t,t),y:ke(e.y,-o,o)}))}},children:[(0,ee.jsx)("img",{ref:Ie,src:ue,alt:"avatar",className:q,style:{transform:"translate(-50%, -50%) translate(".concat(pe.x,"px, ").concat(pe.y,"px) scale(").concat(je,")")},draggable:!1}),(0,ee.jsx)("div",{className:F})]}),(0,ee.jsxs)("div",{className:O,children:[(0,ee.jsxs)("div",{className:B,children:[(0,ee.jsx)("span",{className:W,children:"\u7f29\u653e"}),(0,ee.jsx)($.A,{className:L,min:.1,max:4,step:.01,value:je,onChange:e=>{const s=ke(e,.1,4);if(fe(s),Ie.current&&Ae.current){const e=Ae.current.clientWidth,a=Ie.current,n=a.naturalWidth,r=a.naturalHeight,l=Math.max(e/n,e/r)*s,c=n*l,i=r*l,t=Math.max(0,(c-e)/2),o=Math.max(0,(i-e)/2);ve(e=>({x:ke(e.x,-t,t),y:ke(e.y,-o,o)}))}}})]}),(0,ee.jsxs)("div",{className:J,children:[(0,ee.jsx)(Z.Ay,{onClick:we,children:"\u91cd\u65b0\u9009\u62e9"}),(0,ee.jsx)(Z.Ay,{type:"primary",onClick:()=>{const e=(()=>{const e=Ie.current,s=Ae.current;if(!e||!s)return null;const a=s.clientWidth,n=document.createElement("canvas");n.width=a,n.height=a;const r=n.getContext("2d");if(!r)return null;const l=e.naturalWidth,c=e.naturalHeight,i=Math.max(a/l,a/c)*je,t=l*i,o=c*i,d=a/2+pe.x-t/2,h=a/2+pe.y-o/2;return r.clearRect(0,0,a,a),r.drawImage(e,d,h,t,o),n.toDataURL("image/png")})();e?(console.log("submit_avatar",{avatarDataUrl:e}),H.Ay.success("\u5df2\u6253\u5370\u5230\u63a7\u5236\u53f0"),ie(s=>(0,n.A)((0,n.A)({},s),{},{avatar:e})),xe(!1)):H.Ay.error("\u88c1\u526a\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5")},children:"\u4fdd\u5b58\u5934\u50cf"})]})]})]}):(0,ee.jsx)("div",{className:R,children:(0,ee.jsx)(Z.Ay,{type:"primary",onClick:we,children:"\u9009\u62e9\u56fe\u7247"})})})]})]}),s===ae&&(0,ee.jsxs)("section",{className:m,children:[(0,ee.jsx)("header",{className:x,children:(0,ee.jsx)("h2",{className:u,children:"Change password"})}),(0,ee.jsxs)(G.A,{layout:"vertical",className:b,onFinish:e=>{console.log("change_password",e),H.Ay.success("\u5df2\u6253\u5370\u5230\u63a7\u5236\u53f0"),he(!1)},children:[(0,ee.jsx)(G.A.Item,{label:"Current password",name:"oldPassword",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5f53\u524d\u5bc6\u7801"}],children:(0,ee.jsx)(K.A.Password,{placeholder:"Current password"})}),(0,ee.jsx)(G.A.Item,{label:"New password",name:"newPassword",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u65b0\u5bc6\u7801"}],children:(0,ee.jsx)(K.A.Password,{placeholder:"New password"})}),(0,ee.jsx)(G.A.Item,{label:"Confirm password",name:"confirmPassword",dependencies:["newPassword"],rules:[{required:!0,message:"\u8bf7\u786e\u8ba4\u5bc6\u7801"}],children:(0,ee.jsx)(K.A.Password,{placeholder:"Confirm password"})}),(0,ee.jsx)(Z.Ay,{className:w,htmlType:"submit",children:"Update password"})]})]}),s===re&&(0,ee.jsxs)("section",{className:m,children:[(0,ee.jsx)("header",{className:x,children:(0,ee.jsx)("h2",{className:u,children:"Membership application"})}),(0,ee.jsx)("div",{className:b,children:(0,ee.jsxs)("div",{className:M,children:[(0,ee.jsxs)("div",{children:[(0,ee.jsx)("div",{className:C,children:"Tier"}),(0,ee.jsx)("div",{className:k,children:"\u2014"})]}),(0,ee.jsxs)("div",{children:[(0,ee.jsx)("div",{className:C,children:"Join date"}),(0,ee.jsx)("div",{className:k,children:"\u2014"})]}),(0,ee.jsxs)("div",{children:[(0,ee.jsx)("div",{className:C,children:"Expiry"}),(0,ee.jsx)("div",{className:k,children:"\u2014"})]})]})}),(0,ee.jsxs)("div",{className:b,children:[(0,ee.jsx)("div",{className:S,children:"Propose a new member"}),(0,ee.jsxs)(G.A,{layout:"inline",onFinish:e=>{console.log("propose_member",e),H.Ay.success("\u5df2\u6253\u5370\u5230\u63a7\u5236\u53f0")},className:P,children:[(0,ee.jsx)(G.A.Item,{name:"name",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u59d3\u540d"}],children:(0,ee.jsx)(K.A,{placeholder:"Name"})}),(0,ee.jsx)(G.A.Item,{name:"email",rules:[{required:!0,message:"\u8bf7\u8f93\u5165Email"}],children:(0,ee.jsx)(K.A,{placeholder:"Email"})}),(0,ee.jsx)(G.A.Item,{children:(0,ee.jsx)(Z.Ay,{type:"primary",htmlType:"submit",children:"Submit"})})]})]})]}),s===ne&&(0,ee.jsxs)("section",{className:m,children:[(0,ee.jsxs)("header",{className:x,children:[(0,ee.jsx)("h2",{className:u,children:"Preferences"}),(0,ee.jsx)("p",{className:_,children:"You can set your basic preferences here."})]}),(0,ee.jsx)("div",{className:b,children:"No preferences yet."})]})]})]})})}}}]);
//# sourceMappingURL=411.2d2af7ef.chunk.js.map