"use strict";(self.webpackChunkwebapp=self.webpackChunkwebapp||[]).push([[411],{9411:(e,s,a)=>{a.r(s),a.d(s,{default:()=>de});var r=a(9379),n=a(5043);const l="UserInfo_UserInfoPage__e810E",c="UserInfo_layout__zZ4UQ",i="UserInfo_sideMenu__a3RFU",t="UserInfo_menuItem__OYe7J",o="UserInfo_active__VyX9j",d="UserInfo_arrow__y3enO",h="UserInfo_content__rGOx-",m="UserInfo_section__4H76F",u="UserInfo_headerBar__femp9",x="UserInfo_title__iQeDo",_="UserInfo_sub__AnKl3",f="UserInfo_link__ga2a4",p="UserInfo_profileTop__48vwc",j="UserInfo_leftIntro__iCeAX",v="UserInfo_nameBlock__7EIAT",N="UserInfo_name__f0+if",y="UserInfo_location__wQ8XV",g="UserInfo_fieldList__EjPt4",A="UserInfo_fieldRow__KGF-3",w="UserInfo_fieldLabel__6Dvvb",I="UserInfo_fieldValue__EvUrJ",b="UserInfo_primaryBtn__lyv1k",U="UserInfo_card__aT8Tp",C="UserInfo_metaGrid__Fdt8f",M="UserInfo_metaLabel__RoiiM",P="UserInfo_metaValue__kFyBp",S="UserInfo_modalActions__y9IEl",Y="UserInfo_avatarClickable__6v477",k="UserInfo_avatarModal__ZVD2q",E="UserInfo_cropperBody__vSO+J",F="UserInfo_emptyUploader__IKNl4",X="UserInfo_cropBox__vJJzx",D="UserInfo_cropImage__8Z677",T="UserInfo_cropMask__vEYyq",R="UserInfo_controls__Me8N2",O="UserInfo_scaleRow__CqsM6",L="UserInfo_scaleLabel__U5cu9",q="UserInfo_scaleSlider__UjZ3b",z="UserInfo_actionRow__1yNl1";var V=a(4400),W=a(5964),B=a(5492),G=a(2703),J=a(3625),H=a(5367),Z=a(5981),K=a(4593),Q=a(5558),$=a(2882),ee=a(2544),se=a(1902),ae=a(446),re=a.n(ae),ne=a(579);const le="profile",ce="password",ie="preferences",te="membership";function oe(){const e=function(){try{const e=localStorage.getItem("userInfo");return e?JSON.parse(e):null}catch(e){return null}}(),s=(null===e||void 0===e?void 0:e.user_info)||{};return{username:s.username||"Member",name:s.name||"Accezz",cover_display:s.cover_display||null,location:s.location||null,date_of_birth:s.date_of_birth||null,address:s.address||null,phone:s.phone||null,preferred_name:s.preferred_name||null,communication_preference:s.communication_preference||null,favorite_status:s.favorite_status||!1,hobbies:s.hobbies||null,favorite_artist:s.favorite_artist||null,coffee_order:s.coffee_order||null,dietary_restrictions:s.dietary_restrictions||null}}const de=()=>{var e;const[s,a]=(0,n.useState)(le),[ae,de]=(0,n.useState)(oe()),[he,me]=(0,n.useState)(!1),[ue,xe]=(0,n.useState)(!1),[_e,fe]=(0,n.useState)(!1),[pe,je]=(0,n.useState)(null),[ve,Ne]=(0,n.useState)(1),[ye,ge]=(0,n.useState)({x:0,y:0}),Ae=(0,n.useRef)({dragging:!1,startX:0,startY:0,originX:0,originY:0}),we=(0,n.useRef)({startDistance:0,startScale:1}),Ie=(0,n.useRef)(null),be=(0,n.useRef)(null),Ue=(0,n.useRef)(null),Ce=()=>{ee.A.get({url:"api_v1/user/-1/",actionType:(0,se.A)().GetUserInfo,Success:e=>{de(s=>(0,r.A)((0,r.A)({},s),e))}})};(0,n.useEffect)(()=>{de(oe()),Ce()},[]);const Me=()=>{localStorage.clear(),window.location.reload(!0)},Pe=()=>{var e;null===(e=be.current)||void 0===e||e.click()},Se=(e,s)=>{Ae.current={dragging:!0,startX:e,startY:s,originX:ye.x,originY:ye.y}},Ye=(e,s)=>{const a=Ae.current;if(!a.dragging)return;const r=e-a.startX,n=s-a.startY;ge({x:a.originX+r,y:a.originY+n})},ke=()=>{Ae.current.dragging=!1},Ee=(e,s,a)=>Math.max(s,Math.min(a,e)),Fe=(0,n.useMemo)(()=>(0,ne.jsxs)("aside",{className:i,children:[(0,ne.jsxs)("div",{className:s===le?"".concat(t," ").concat(o):t,onClick:()=>a(le),children:[(0,ne.jsx)("span",{children:"Profile"}),(0,ne.jsx)("span",{className:d,children:"\u203a"})]}),(0,ne.jsxs)("div",{className:s===ce?"".concat(t," ").concat(o):t,onClick:()=>a(ce),children:[(0,ne.jsx)("span",{children:"Change password"}),(0,ne.jsx)("span",{className:d,children:"\u203a"})]}),(0,ne.jsxs)("div",{className:s===ie?"".concat(t," ").concat(o):t,onClick:()=>a(ie),children:[(0,ne.jsx)("span",{children:"Preferences"}),(0,ne.jsx)("span",{className:d,children:"\u203a"})]}),(0,ne.jsxs)("div",{className:s===te?"".concat(t," ").concat(o):t,onClick:()=>a(te),children:[(0,ne.jsx)("span",{children:"Membership application"}),(0,ne.jsx)("span",{className:d,children:"\u203a"})]}),(0,ne.jsxs)("div",{className:t,onClick:Me,children:[(0,ne.jsx)("span",{children:"Sign out"}),(0,ne.jsx)("span",{className:d,children:"\u203a"})]})]}),[s]),Xe=/^\d+$/,De=/^[a-zA-Z]+$/;return(0,ne.jsx)("div",{className:l,children:(0,ne.jsxs)("div",{className:c,children:[Fe,(0,ne.jsxs)("main",{className:h,children:[s===le&&(0,ne.jsxs)("section",{className:m,children:[(0,ne.jsxs)("header",{className:u,children:[(0,ne.jsx)("h2",{className:x,children:"Profile"}),(0,ne.jsxs)("p",{className:_,children:["Here, you can edit your phone number and information address. Others cannot see this information. If your repeated repair fails, please ",(0,ne.jsx)("a",{className:f,href:"mailto:advisory@theaccezz.com",children:"Contact us"})]})]}),(0,ne.jsx)("div",{className:p,children:(0,ne.jsxs)("div",{className:j,children:[(0,ne.jsx)("div",{className:Y,onClick:()=>{fe(!0)},title:"\u70b9\u51fb\u66f4\u6362\u5934\u50cf",children:(0,ne.jsx)(W.A,{size:80,src:ee.A.returnFileUrl(ae.cover_display),children:null===(e=ae.username)||void 0===e?void 0:e[0]})}),(0,ne.jsxs)("div",{className:v,children:[(0,ne.jsx)("div",{className:N,children:ae.username}),(0,ne.jsxs)("div",{className:y,children:["Location: ",ae.location||"-"]})]})]})}),(0,ne.jsxs)("div",{className:g,children:[(0,ne.jsxs)("div",{className:A,children:[(0,ne.jsx)("div",{className:w,children:"Preferred name"}),(0,ne.jsx)("div",{className:I,children:ae.preferred_name})]}),(0,ne.jsxs)("div",{className:A,children:[(0,ne.jsx)("div",{className:w,children:"Birthday"}),(0,ne.jsx)("div",{className:I,children:ae.date_of_birth||"-"})]}),(0,ne.jsxs)("div",{className:A,children:[(0,ne.jsx)("div",{className:w,children:"Location"}),(0,ne.jsx)("div",{className:I,children:ae.location||"-"})]}),(0,ne.jsxs)("div",{className:A,children:[(0,ne.jsx)("div",{className:w,children:"Gender"}),(0,ne.jsx)("div",{className:I,children:ae.gender||"-"})]}),(0,ne.jsxs)("div",{className:A,children:[(0,ne.jsx)("div",{className:w,children:"Communication preference"}),(0,ne.jsx)("div",{className:I,children:ae.communication_preference||"-"})]}),(0,ne.jsxs)("div",{className:A,children:[(0,ne.jsx)("div",{className:w,children:"Collecting status "}),(0,ne.jsx)("div",{className:I,children:(null===ae||void 0===ae?void 0:ae.favorite_status)&&(0,ne.jsx)($.A,{twoToneColor:"#52c41a"})})]}),(0,ne.jsxs)("div",{className:A,children:[(0,ne.jsx)("div",{className:w,children:"Interests"}),(0,ne.jsx)("div",{className:I,children:ae.hobbies||"-"})]}),(0,ne.jsxs)("div",{className:A,children:[(0,ne.jsx)("div",{className:w,children:"Favourite artists"}),(0,ne.jsx)("div",{className:I,children:ae.favorite_artist||"-"})]}),(0,ne.jsxs)("div",{className:A,children:[(0,ne.jsx)("div",{className:w,children:"Coffee order"}),(0,ne.jsx)("div",{className:I,children:ae.coffee_order||"-"})]}),(0,ne.jsxs)("div",{className:A,children:[(0,ne.jsx)("div",{className:w,children:" Dietary restrictions"}),(0,ne.jsx)("div",{className:I,children:ae.dietary_restrictions||"-"})]})]}),(0,ne.jsx)(B.Ay,{className:b,onClick:()=>me(!0),children:"Personal center form"}),(0,ne.jsx)(G.A,{title:"Edit profile",open:he,onCancel:()=>me(!1),footer:null,destroyOnClose:!0,children:(0,ne.jsxs)(J.A,{layout:"vertical",initialValues:ae,onFinish:e=>{const s=(0,r.A)({},e);ee.A.patch({url:"/api_v1/user/-1/",data:s,actionType:(0,se.A)().PatchUserInfo,Success:()=>{Ce(),de(s=>(0,r.A)((0,r.A)({},s),e)),V.Ay.success("\u221a")}}),me(!1)},children:[(0,ne.jsx)(J.A.Item,{label:"Preferred name",name:"preferred_name",rules:[{required:!0,message:"Please enter your Preferred name"}],children:(0,ne.jsx)(H.A,{placeholder:"preferred_name"})}),(0,ne.jsx)(J.A.Item,{label:"Date of birth",name:"date_of_birth",getValueProps:e=>({value:e?re()(e):null}),normalize:e=>e?re()(e).format("YYYY-MM-DD"):null,children:(0,ne.jsx)(Z.A,{style:{width:"100%"}})}),(0,ne.jsx)(J.A.Item,{label:"Location",name:"location",children:(0,ne.jsx)(H.A,{placeholder:"location"})}),(0,ne.jsx)(J.A.Item,{label:"Gender",name:"gender",children:(0,ne.jsxs)(K.Ay.Group,{children:[(0,ne.jsx)(K.Ay,{value:"Female",children:" Female "}),(0,ne.jsx)(K.Ay,{value:"Male",children:" Male "}),(0,ne.jsx)(K.Ay,{value:"Other",children:" Other "})]})}),(0,ne.jsx)(J.A.Item,{label:"Communication preference",name:"communication_preference",children:(0,ne.jsx)(H.A,{placeholder:"communication_preference"})}),(0,ne.jsx)(J.A.Item,{label:"Collecting status",name:"favorite_status",children:(0,ne.jsxs)(K.Ay.Group,{children:[(0,ne.jsx)(K.Ay,{value:!0,children:" YES "}),(0,ne.jsx)(K.Ay,{value:!1,children:"NO "})]})}),(0,ne.jsx)(J.A.Item,{label:"Interests",name:"hobbies",children:(0,ne.jsx)(H.A,{placeholder:"hobbies"})}),(0,ne.jsx)(J.A.Item,{label:"Favourite artists",name:"favorite_artist",children:(0,ne.jsx)(H.A,{placeholder:"favorite_artist"})}),(0,ne.jsx)(J.A.Item,{label:"Coffee order",name:"coffee_order",children:(0,ne.jsx)(H.A,{placeholder:"coffee_order"})}),(0,ne.jsx)(J.A.Item,{label:"Dietary restrictions",name:"dietary_restrictions",children:(0,ne.jsx)(H.A,{placeholder:"dietary_restrictions"})}),(0,ne.jsxs)("div",{className:S,children:[(0,ne.jsx)(B.Ay,{onClick:()=>me(!1),children:"Cancel"}),(0,ne.jsx)(B.Ay,{type:"primary",htmlType:"submit",children:"Save"})]})]})}),(0,ne.jsxs)(G.A,{title:"Change avatar",open:_e,onCancel:()=>fe(!1),footer:null,destroyOnClose:!0,className:k,children:[(0,ne.jsx)("input",{ref:be,type:"file",accept:"image/*",style:{display:"none"},onChange:e=>{var s;const a=null===(s=e.target.files)||void 0===s?void 0:s[0];if(!a)return;const r=new FileReader;r.onload=()=>{je(r.result),Ne(1),ge({x:0,y:0})},r.readAsDataURL(a),e.target.value=""}}),(0,ne.jsx)("div",{className:E,children:pe?(0,ne.jsxs)(ne.Fragment,{children:[(0,ne.jsxs)("div",{className:X,ref:Ue,onMouseDown:e=>{e.preventDefault(),Se(e.clientX,e.clientY)},onMouseMove:e=>{Ye(e.clientX,e.clientY)},onMouseUp:ke,onMouseLeave:ke,onTouchStart:e=>{const s=e.touches;if(1===s.length){const e=s[0];Se(e.clientX,e.clientY)}else if(2===s.length){const e=s[0],a=s[1],r=Math.sqrt(Math.pow(a.clientX-e.clientX,2)+Math.pow(a.clientY-e.clientY,2));we.current={startDistance:r,startScale:ve}}},onTouchMove:e=>{const s=e.touches;if(1===s.length){const e=s[0];Ye(e.clientX,e.clientY)}else if(2===s.length){const e=s[0],a=s[1],r=Math.sqrt(Math.pow(a.clientX-e.clientX,2)+Math.pow(a.clientY-e.clientY,2)),{startDistance:n,startScale:l}=we.current;if(n>0){const e=Ee(l*(r/n),.5,4);if(Ne(e),Ie.current&&Ue.current){const s=Ue.current.clientWidth,a=Ie.current,r=a.naturalWidth,n=a.naturalHeight,l=Math.max(s/r,s/n)*e,c=r*l,i=n*l,t=Math.max(0,(c-s)/2),o=Math.max(0,(i-s)/2);ge(e=>({x:Ee(e.x,-t,t),y:Ee(e.y,-o,o)}))}}}},onTouchEnd:ke,onWheel:e=>{e.preventDefault();const s=e.deltaY>0?-.1:.1,a=Ee(ve+s,.5,4);if(Ne(a),Ie.current&&Ue.current){const e=Ue.current.clientWidth,s=Ie.current,r=s.naturalWidth,n=s.naturalHeight,l=Math.max(e/r,e/n)*a,c=r*l,i=n*l,t=Math.max(0,(c-e)/2),o=Math.max(0,(i-e)/2);ge(e=>({x:Ee(e.x,-t,t),y:Ee(e.y,-o,o)}))}},children:[(0,ne.jsx)("img",{ref:Ie,src:pe,alt:"avatar",className:D,style:{transform:"translate(-50%, -50%) translate(".concat(ye.x,"px, ").concat(ye.y,"px) scale(").concat(ve,")")},draggable:!1}),(0,ne.jsx)("div",{className:T})]}),(0,ne.jsxs)("div",{className:R,children:[(0,ne.jsxs)("div",{className:O,children:[(0,ne.jsx)("span",{className:L,children:"\u7f29\u653e"}),(0,ne.jsx)(Q.A,{className:q,min:.1,max:4,step:.01,value:ve,onChange:e=>{const s=Ee(e,.1,4);if(Ne(s),Ie.current&&Ue.current){const e=Ue.current.clientWidth,a=Ie.current,r=a.naturalWidth,n=a.naturalHeight,l=Math.max(e/r,e/n)*s,c=r*l,i=n*l,t=Math.max(0,(c-e)/2),o=Math.max(0,(i-e)/2);ge(e=>({x:Ee(e.x,-t,t),y:Ee(e.y,-o,o)}))}}})]}),(0,ne.jsxs)("div",{className:z,children:[(0,ne.jsx)(B.Ay,{onClick:Pe,children:"\u91cd\u65b0\u9009\u62e9"}),(0,ne.jsx)(B.Ay,{type:"primary",onClick:()=>{const e=(()=>{const e=Ie.current,s=Ue.current;if(!e||!s)return null;const a=s.clientWidth,r=document.createElement("canvas");r.width=a,r.height=a;const n=r.getContext("2d");if(!n)return null;const l=e.naturalWidth,c=e.naturalHeight,i=Math.max(a/l,a/c)*ve,t=l*i,o=c*i,d=a/2+ye.x-t/2,h=a/2+ye.y-o/2;return n.clearRect(0,0,a,a),n.drawImage(e,d,h,t,o),r.toDataURL("image/png")})();if(!e)return void V.Ay.error("\u88c1\u526a\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5");const s=e.split(",")[1],a=atob(s),r=new Uint8Array(a.length);for(let c=0;c<a.length;c++)r[c]=a.charCodeAt(c);const n=new Blob([r],{type:"image/jpeg"}),l=new FormData;l.append("file",n,"avatar.jpg"),ee.A.post({url:"api_v1/file_upload/",data:l,actionType:(0,se.A)().PostFiles,Success:e=>{const s=null===e||void 0===e?void 0:e.cloud_id;ee.A.patch({url:"/api_v1/user/-1/",data:{cover:s},actionType:(0,se.A)().PatchUserInfo,Success:()=>{Ce()}})},Error:e=>{console.log(e)}}),fe(!1)},children:"\u4fdd\u5b58\u5934\u50cf"})]})]})]}):(0,ne.jsx)("div",{className:F,children:(0,ne.jsx)(B.Ay,{type:"primary",onClick:Pe,children:"\u9009\u62e9\u56fe\u7247"})})})]})]}),s===ce&&(0,ne.jsxs)("section",{className:m,children:[(0,ne.jsx)("header",{className:u,children:(0,ne.jsx)("h2",{className:x,children:"Change password"})}),(0,ne.jsxs)(J.A,{layout:"vertical",className:U,onFinish:e=>{console.log("change_password",e),ee.A.post({url:"programmer/set_password/",data:e,actionType:(0,se.A)().postPassword,Success:e=>{V.Ay.success("Password changed successfully, please log in again \u221a "),ee.A.LogOut()},Error:()=>{V.Ay.error("X")}}),xe(!1)},children:[(0,ne.jsx)(J.A.Item,{label:"Current password",name:"old_password",rules:[{required:!0,message:"Please enter the current password"}],children:(0,ne.jsx)(H.A.Password,{placeholder:"Current password"})}),(0,ne.jsx)(J.A.Item,{label:"New password",name:"new_password",rules:[{required:!0,message:"Please enter a new password"},{min:8,message:"Password must be at least 8 characters"},{max:20,message:"Password cannot exceed 20 characters"},e=>{let{getFieldValue:s}=e;return{validator:(e,a)=>a&&s("old_password")===a?Promise.reject(new Error("New password cannot be the same as current password")):Promise.resolve()}},{validator:(e,s)=>s&&Xe.test(s)?Promise.reject(new Error("Password cannot be all numbers")):Promise.resolve()},{validator:(e,s)=>s&&De.test(s)?Promise.reject(new Error("Password cannot be all letters")):Promise.resolve()}],children:(0,ne.jsx)(H.A.Password,{placeholder:"New password"})}),(0,ne.jsx)(J.A.Item,{label:"Confirm password",name:"confirmPassword",dependencies:["new_password"],rules:[{required:!0,message:"Please confirm the password"},e=>{let{getFieldValue:s}=e;return{validator:(e,a)=>a&&s("new_password")!==a?Promise.reject(new Error("The two passwords that you entered do not match!")):Promise.resolve()}}],children:(0,ne.jsx)(H.A.Password,{placeholder:"Confirm password"})}),(0,ne.jsx)(B.Ay,{className:b,htmlType:"submit",children:"Update password"})]})]}),s===te&&(0,ne.jsxs)("section",{className:m,children:[(0,ne.jsx)("header",{className:u,children:(0,ne.jsx)("h2",{className:x,children:"Membership application"})}),(0,ne.jsx)("div",{className:U,children:(0,ne.jsxs)("div",{className:C,children:[(0,ne.jsxs)("div",{children:[(0,ne.jsx)("div",{className:M,children:"Tier"}),(0,ne.jsx)("div",{className:P,children:(null===ae||void 0===ae?void 0:ae.tier)||"--"})]}),(0,ne.jsxs)("div",{children:[(0,ne.jsx)("div",{className:M,children:"Join date"}),(0,ne.jsx)("div",{className:P,children:(null===ae||void 0===ae?void 0:ae.joining_date)||"--"})]}),(0,ne.jsxs)("div",{children:[(0,ne.jsx)("div",{className:M,children:"Expiry"}),(0,ne.jsx)("div",{className:P,children:(null===ae||void 0===ae?void 0:ae.expiry)||"--"})]})]})})]}),s===ie&&(0,ne.jsxs)("section",{className:m,children:[(0,ne.jsxs)("header",{className:u,children:[(0,ne.jsx)("h2",{className:x,children:"Preferences"}),(0,ne.jsx)("p",{className:_,children:"You can set your basic preferences here."})]}),(0,ne.jsx)("div",{className:U,children:"No preferences yet."})]})]})]})})}}}]);
//# sourceMappingURL=411.ebf654b6.chunk.js.map